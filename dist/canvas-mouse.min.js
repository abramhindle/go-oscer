/*
	canvas-mouse 0.7.0-alpha
	Copyright (c) 2017 Epistemex
	MIT license.
*/
"use strict";function CanvasMouse(h,s){if(!(h instanceof CanvasRenderingContext2D)){throw"Need a 2D canvas context."}s=Object.assign({handleScale:!1,handleTransforms:!1,matrix:null,plugins:[]},s);var r=this,i=Object.defineProperty.bind(Object),x,n=("currentTransform" in h||"mozCurrentTransform" in h),w=s.plugins,j,k,y,z,t,u,g=h.canvas,q=s.matrix,o=q?q.inverse():null,l=s.handleScale,m=s.handleTransforms&&(n||q),A=q?e:d;if(m&&!n&&!q){console.log("currentTransform not supported by browser");m=!1}function v(){if(q&&!q._xx){q._xx=q._x;q._x=function(){o=this.inverse();return this._xx()}}}function p(){var M=g.getBoundingClientRect(),G=getComputedStyle(g),J=G.getPropertyValue.bind(G),I=parseInt,D="padding-",C="border-",E="-width",H="left",K="right",N="top",F="bottom";t=I(J(D+H))+I(J(C+H+E));u=I(J(D+N))+I(J(C+N+E));j=M.left+t;k=M.top+u;y=(g.width/(M.width-(t+I(J(D+K))+I(J(C+K+E)))))||1;z=(g.height/(M.height-(u+I(J(D+F))+I(J(C+F+E)))))||1}function b(){cancelAnimationFrame(x);x=requestAnimationFrame(f)}function f(){var B=g.getBoundingClientRect();j=B.left+t;k=B.top+u}function a(B){return{x:B.clientX-j,y:B.clientY-k,timeStamp:B.timeStamp}}function c(B){B.x*=y;B.y*=z;return B}function d(E){var B=(h.currentTransform||h.mozCurrentTransform),D,C;if(B instanceof SVGMatrix){B=DOMMatrix.fromMatrix(B)}D=typeof B.a==="undefined"?new DOMMatrix(B):B;C=D.invertSelf();return{x:E.x*C.a+E.y*C.c+C.e,y:E.x*C.b+E.y*C.d+C.f,timeStamp:E.timeStamp}}function e(C){var B=o.applyToPoint(C.x,C.y);return{x:B.x,y:B.y,timeStamp:C.timeStamp}}this.getPos=function(B){var D=a(B);if(l){D=c(D)}if(m){D=A(D)}if(w.length){for(var C=0;C<w.length;C++){D=w[C].handler(B,D)}}return D};this.getPosXY=function(C,D){var B;if(arguments.length===1){D=C.y;B=C.x}else{B=C}return r.getPos({clientX:B/y+j,clientY:D/z+k,timestamp:Date.now()})};this.addPlugin=function(B){if(w.indexOf(B)<0){w.push(B)}};this.removePlugin=function(C){var B=w.indexOf(C);if(B>-1){w.splice(B,1)}};this.init=p;this.update=f;i(r,"handleScale",{get:function(){return l},set:function(B){l=!!B}});i(r,"handleTransforms",{get:function(){return m},set:function(B){m=!!B&&(n||q)}});i(r,"matrix",{get:function(){return q},set:function(B){q=B;m=m&&(n||q);v()}});v();p();window.addEventListener("scroll",b);window.addEventListener("resize",b)};