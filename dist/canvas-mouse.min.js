/*
	canvas-mouse ver 0.2.0
	Copyright (c) 2017 Epistemex
	www.epistemex.com
*/
"use strict";function CanvasMouse(b,g){if(!(b instanceof CanvasRenderingContext2D)){throw"Need a 2D canvas context."}var f=this,h;g=Object.assign({level:"basic",matrix:null,inverseHack:!0},g);var e=Math.max(0,["basic","scale","transforms"].indexOf(g.level));var c=("currentTransform" in b||"mozCurrentTransform" in b);this.context=b;this.canvas=b.canvas;this.matrix=g.matrix;if(this.matrix&&g.inverseHack){this.matrix._xx=this.matrix._x;this.matrix._x=function(){f.imatrix=this.inverse();return this._xx()}}this.deltaX=this.deltaY=0;this.scaleX=this.scaleY=1;if(e===2&&(!c||this.matrix)){if(this.matrix){e=3}else{throw"Warning: browser doesn't support currentTransform()."}}this.getPos=[this._basic,this._scale,this._transforms,this._transforms2][e];this.pl=0;this.pt=0;this.init=d;this.update=i;function d(){var w=canvas.getBoundingClientRect(),q=getComputedStyle(canvas),u=q.getPropertyValue.bind(q),k="padding-",j="border-",l="-width",s=parseInt(u(k+"left")),t=parseInt(u(k+"right")),v=parseInt(u(k+"top")),r=parseInt(u(k+"bottom")),n=parseInt(u(j+"left"+l)),o=parseInt(u(j+"right"+l)),p=parseInt(u(j+"top"+l)),m=parseInt(u(j+"bottom"+l));f.pl=s+n;f.pt=v+p;f.deltaX=w.left+f.pl;f.deltaY=w.top+f.pt;f.scaleX=canvas.width/(w.width-f.pl-t-o);f.scaleY=canvas.height/(w.height-f.pt-r-m)}function i(){var j=canvas.getBoundingClientRect();f.deltaX=j.left+f.pl;f.deltaY=j.top+f.pt}window.addEventListener("scroll",a);window.addEventListener("resize",a);function a(){cancelAnimationFrame(h);h=requestAnimationFrame(i)}d()}CanvasMouse.prototype={_basic:function(a){return{x:a.clientX-this.deltaX,y:a.clientY-this.deltaY}},_scale:function(a){return{x:(a.clientX-this.deltaX)*this.scaleX,y:(a.clientY-this.deltaY)*this.scaleY}},_transforms:function(c){var g,f,a,d,b=this.context;g=this._scale(c);a=(b.currentTransform||b.mozCurrentTransform);if(a instanceof SVGMatrix){a=DOMMatrix.fromMatrix(a)}f=typeof a.a==="undefined"?new DOMMatrix(a):a;d=f.invertSelf();return{x:g.x*d.a+g.y*d.c+d.e,y:g.x*d.b+g.y*d.d+d.f}},_transforms2:function(a){var b=this._scale(a);return this.imatrix.applyToPoint(b.x,b.y)},getPosXY:function(a,b){return this.getPos({clientX:a/this.scaleX+this.deltaX,clientY:b/this.scaleY+this.deltaY})}};